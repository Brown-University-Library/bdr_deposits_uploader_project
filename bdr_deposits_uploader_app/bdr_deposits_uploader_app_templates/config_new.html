{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BDR Deposits Configurator</title>
    <link rel="stylesheet" href="{% static 'bdr_deposits_uploader_app/css/config.css' %}">
    <script src="https://unpkg.com/htmx.org"></script>
</head>
<body>
    
<!-- 
    <header>
        <h1>Brown University Library</h1>
    </header>
 -->

    <header>
        <div class="header-content">
            <h1>Brown University Library</h1>
            {% if username %}
            <span class="welcome-text">Welcome {{ username }}</span>
            {% endif %}
        </div>
    </header>

    <main>

        <section class="form-section">
            <h2>Create new deposits app</h2>
            <!-- <form id="new-app-form" hx-post="/hlpr_check_name_and_slug/" hx-target="#response" hx-swap="innerHTML"> -->
            <form id="new-app-form" hx-post="{{hlpr_check_name_and_slug_url}}" hx-target="#response" hx-swap="innerHTML">
                {% csrf_token %}
                <div style="display: flex; align-items: center; margin-bottom: 1rem;">
                    <label for="new-app-name" style="margin-right: 1rem; width: 150px; text-align: right;">New App Name:</label>
                    
                    <input 
                        id="new-app-name" 
                        name="new_app_name" 
                        type="text" 
                        placeholder="Enter name of new app" 
                        hx-post="{{hlpr_generate_slug_url}}" 
                        hx-trigger="input changed delay:250ms" 
                        hx-target="#url-slug" 
                        hx-swap="outerHTML" 
                        hx-indicator=".htmx-indicator"
                    >

                </div>
                <div style="display: flex; align-items: center; margin-bottom: 1rem;">
                    <label for="url-slug" style="margin-right: 1rem; width: 150px; text-align: right;">URL Slug:</label>
                    <input id="url-slug" name="url_slug" type="text" placeholder="Auto-generated or enter manually">
                </div>
                <button type="submit" class="btn-primary">Submit</button>
            </form>
            <div id="response" class="alert"></div>
        </section>

        <hr/>
        <section class="recent-items-section">
            <h2>Recent deposits apps</h2> 
            <table class="styled-table">
                <thead>
                    <tr>
                        <th>Modified-Date</th>
                        <th>Name</th>
                        <th>Items-Count</th>
                        <th>Config</th>
                        <th>Upload</th>
                        <th>More Info</th>
                    </tr>
                </thead>
                <tbody>
                    {% for app in recent_apps %}
                    <tr>
                        <td>{{ app.mod_date }}</td>
                        <td>{{ app.name }}</td>
                        <td>{{ app.items_count }}</td>
                        <td><a href="{{ app.config_link }}" class="btn-link">config</a></td>
                        <td><a href="{{ app.upload_link }}" class="btn-link">upload</a></td>
                        <td><a href="{% url 'admin:index' %}" class="btn-link">admin</a></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </section>
        <div style="font-style: italic; margin-top: 1rem; text-align: center;">(dummy data for now)</div>
    </main>
    
    <!-- <script>
        function updateSlug(name) {
            const slugInput = document.getElementById('url-slug');
            const slug = name
                .toLowerCase()
                .replace(/&/g, 'and')
                .replace(/[^a-z0-9\s-]/g, '')
                .trim()
                .replace(/\s+/g, '-')
                .replace(/-+/g, '-');
            slugInput.value = slug;
        }
    </script> -->
    
    <!-- 
    <footer>
        <p>Â© 2024 Brown University Library</p>
    </footer> 
    -->

    <hr/>

</body>
</html>
